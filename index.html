<!DOCTYPE html>
html
<script>
/* ============================================
      ÁRBOL MUY DEFINIDO EN FORMA DE CORAZÓN
   ============================================ */

const canvas = document.getElementById("treeCanvas");
const ctx = canvas.getContext("2d", { alpha: true });

let W, H, DPR;

function fit() {
    DPR = Math.min(window.devicePixelRatio || 1, 2);
    const r = canvas.getBoundingClientRect();
    W = r.width;
    H = r.height;
    canvas.width = W * DPR;
    canvas.height = H * DPR;
    ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
}
fit();
addEventListener("resize", fit);

// Paleta rojo/rosa
const PALETTE = [
    "#ff1744", "#ff335f", "#e53935", "#ff4d4d",
    "#ff6f91", "#ff8a80", "#f06292", "#ff99a5",
    "#ffadc2", "#ff7a90"
];

/*  
    NUEVA FUNCIÓN: corazón mucho más definido.
    Esta versión es EXACTA a la curva clásica
    y genera una silueta muy nítida.
*/
function inHeart(x, y) {
    // Ajustamos la ecuación para hacerlo más “aplanado” arriba
    const xx = x * 1.15;
    const yy = y * 1.05;

    const a = xx * xx + yy * yy - 1;
    return (a * a * a - xx * xx * yy * yy * yy) <= 0;
}

const leaves = [];
const falling = [];

// CREA LOS PUNTOS DE LA COPA DEL CORAZÓN
function seed() {
    leaves.length = 0;
    falling.length = 0;

    const cx = W * 0.64; // posición a la derecha
    const cy = H * 0.45;
    const sx = W * 0.19;
    const sy = H * 0.23;

    const COUNT = 900;  // MUCHÍSIMO MÁS AGRUPADO
    for (let i = 0; i < COUNT; i++) {
        let nx, ny, tries = 0;
        do {
            nx = (Math.random() * 2.4 - 1.2);
            ny = (Math.random() * 2.4 - 1.2);
            tries++;
            if (tries > 30) break;
        } while (!inHeart(nx, ny));

        // Bordes más densos (como en la imagen)
        if (Math.random() < 0.35) {
            const edgeBoost = (Math.random() * 0.08) + 0.92;
            nx *= edgeBoost;
            ny *= edgeBoost;
        }

        const x = cx + nx * sx + (Math.random() - 0.5) * 4;
        const y = cy + ny * sy + (Math.random() - 0.5) * 4;

        leaves.push({
            baseX: x, baseY: y,
            x, y,
            size: 8 + Math.random() * 12,
            rot: Math.random() * Math.PI,
            color: PALETTE[(Math.random() * PALETTE.length) | 0],
            swayA: 4 + Math.random() * 6,
            swayW: 0.6 + Math.random() * 1.0,
            t0: Math.random() * 1000
        });
    }
}
seed();

// Corazón dibujado
function drawHeart(x, y, s, rot, col) {
    ctx.save();
    ctx.translate(x, y);
    ctx.rotate(rot);
    ctx.scale(s * 0.1, s * 0.1);

    ctx.beginPath();
    ctx.moveTo(0, -10);
    ctx.bezierCurveTo(12, -24, 34, -14, 0, 12);
    ctx.bezierCurveTo(-34, -14, -12, -24, 0, -10);
    ctx.closePath();

    ctx.fillStyle = col;
    ctx.shadowColor = "rgba(0,0,0,.12)";
    ctx.shadowBlur = 2;
    ctx.fill();
    ctx.restore();
}

// tronco
function drawTrunk() {
    const bx = W * 0.63, top = H * 0.56, bottom = H * 0.90;
    ctx.fillStyle = "#8f5f30";
    ctx.beginPath();
    ctx.moveTo(bx - 14, top);
    ctx.lineTo(bx + 14, top);
    ctx.lineTo(bx + 22, bottom);
    ctx.lineTo(bx - 22, bottom);
    ctx.closePath();
    ctx.fill();
}

const FALL_PROB = 0.0011;
const WIND = 0.34;

let t0 = performance.now();
function render(t) {
    const tt = (t - t0) / 1000;

    ctx.clearRect(0, 0, W, H);

    const g = ctx.createLinearGradient(0, 0, 0, H);
    g.addColorStop(0, "#faefe7");
    g.addColorStop(1, "#f1e3d7");
    ctx.fillStyle = g;
    ctx.fillRect(0, 0, W, H);

    drawTrunk();

    // Hojas fijas
    for (const leaf of leaves) {
        const wind = Math.sin((tt + leaf.t0) * leaf.swayW) * leaf.swayA * WIND;
        const x = leaf.baseX + wind;
        const y = leaf.baseY + Math.sin((tt + leaf.t0) * leaf.swayW * 0.9) * 1.4;
        const r = leaf.rot + Math.sin((tt + leaf.t0) * leaf.swayW) * 0.14;

        drawHeart(x, y, leaf.size, r, leaf.color);

        if (Math.random() < FALL_PROB && x < W * 0.70) {
            falling.push({
                x, y,
                vx: -(0.35 + Math.random() * 0.5),
                vy: (0.25 + Math.random() * 0.4),
                rot: r,
                vr: (Math.random() - 0.5) * 0.04,
                size: leaf.size,
                color: leaf.color
            });
        }
    }

    // Hojas cayendo
    for (let i = falling.length - 1; i >= 0; i--) {
        const f = falling[i];
        f.vx += -0.002;
        f.vy += 0.018;
        f.x += f.vx * 1.4;
        f.y += f.vy * 1.4;
        f.rot += f.vr;

        drawHeart(f.x, f.y, f.size, f.rot, f.color);
        if (f.y > H + 40 || f.x < -40) falling.splice(i, 1);
    }

    requestAnimationFrame(render);
}
requestAnimationFrame(render);
</script>

